@model DTOLayer.BaiVietDienDanDTO
@using Helpers
@using LCTMoodle.LCTHtml

@{
    var quyen = (string[])ViewData["Quyen"];
    int maNguoiDung = Session["NguoiDung"] == null ? 0 : (int)Session["NguoiDung"];

    bool
        coQuyenXoa = maNguoiDung == Model.nguoiTao.ma || QuyenHelper.co(quyen, "DienDan_Xoa") || true,
        coQuyenSua = maNguoiDung == Model.nguoiTao.ma || true;
}

<li data-doi-tuong="muc-bai-viet" class="muc-bai-viet" data-ma="@Model.ma" @(Model.ghim ? "data-ghim" : null) >
    <section class="khung-bai-viet">
        <section class="khung-thong-tin">
            <section class="trai">
                <article class="hinh-dai-dien">
                    <img src="/boy.png/" />
                </article>
            </section>
            <section class="phai">
                <section class="nguoi-dung">
                    <a href="#">@NguoiDungHtml.link(Model.nguoiTao)</a>
                </section>
                <section class="bai-viet">
                    <section class="thoi-gian">
                        @Model.thoiDiemTao.Value.ToString("H:mm d/M/yyyy")
                    </section>
                </section>
            </section>            
        </section>
        <section data-doi-tuong="khung-noi-dung" class="khung-noi-dung">
            <h2 class="tieu-de">
                @Model.tieuDe
            </h2>
            <section class="noi-dung noi-dung-ckeditor">
                @Html.Raw(Model.noiDung)
            </section>            
            @if (@Model.tapTin != null)
            {
                <section class="tap-tin">
                    <a href="/LayTapTin/BaiVietDienDan_TapTin/@Model.tapTin.ma">
                        <img src="/LayTapTin/BaiVietDienDan_TapTin/@Model.tapTin.ma" />
                        <span>@Model.tapTin.ten</span>
                    </a>
                </section>
            }
        </section>
        <section class="khung-chuc-nang-lct ben-trai" style="top: 10px; right: 10px;">
            <ul data-doi-tuong="cndd-@Model.ma">
                <li>
                    <a data-chuc-nang="ghim-bai-viet">Ghim bài viết</a>
                </li>
                @if (coQuyenSua)
                {
                    <li>
                        <a data-chuc-nang="sua-bai-viet">Sửa bài viết</a>
                    </li>
                }
                @if (coQuyenXoa)
                {
                    <li>
                        <a data-chuc-nang="xoa-bai-viet">Xóa bài viết</a>
                    </li>
                }
            </ul>
            <button data-chuc-nang="tat-mo" data-mo-doi-tuong="cndd-@Model.ma">
                <i class="pe-7f-config"></i>
            </button>
        </section>
    </section>
    @Html.Partial("~/Views/BinhLuan/_Khung.cshtml", null, new ViewDataDictionary()
        {
            { "LoaiDoiTuong", "BaiVietDienDan" },
            { "MaDoiTuong", Model.ma }
        })
</li>